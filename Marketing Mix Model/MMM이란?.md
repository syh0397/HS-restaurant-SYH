# MMM

## 1. MMMì´ë€?

### MMM : Marketing Mix Modeling

* ë§ˆì¼€íŒ…ì˜ ë¹„ìš© ëŒ€ë¹„ íš¨ìš©(ë§¤ì¶œ), â€˜ROIâ€™ì˜ ì •ëŸ‰ì ì´ê³  ì²´ê³„ì ì¸ ì¸¡ì •ì„ ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ë¶„ì„ ë°©ë²•ìœ¼ë¡œ, ë§ˆì¼€íŒ… ë¹„ìš©ê³¼ ë§¤ì¶œì„ ì¸ê³¼ê´€ê³„ë¡œ ì •ì˜í•˜ê³  ìƒê´€ì„±ì„ ë°í˜€ë‚´ê³ ì í•˜ëŠ” ê²ƒ
* 1980ë…„ í›„ë°˜ë¶€í„° ì´ë¯¸ ê¸€ë¡œë²Œ ì†Œë¹„ì¬ ê¸°ì—…ë“¤ì´ í™œìš©í•´ì™”ìœ¼ë©°, ì²˜ìŒìœ¼ë¡œ ë„ì…í•œ íšŒì‚¬ëŠ” P&G, í¬ë˜í”„íŠ¸, ìœ ë‹ˆë ˆë²„ ë“±ì´ ìˆìŒ
  <aside>
  ğŸ’¡ **ì™œ MMMì´ ì¤‘ìš”í• ê¹Œìš”?**
  ë§¥í‚¨ì§€ ì„¤ë¬¸ì¡°ì‚¬ì— ë”°ë¥´ë©´,
  - ê¸€ë¡œë²Œ ê¸°ì—… ê²½ì˜ì§„ì˜ 60%ëŠ” **ROIë¥¼ ê³„ì‚°í•  ìˆ˜ ì—†ì–´** ì†Œì…œë¯¸ë””ì–´ ì´ìš©ì— ê´€ì‹¬ì´ ì—†ë‹¤ê³  ë‹µí•¨
  - CEOì˜ 80%ëŠ” **ë§ˆì¼€íŒ… ë¶€ì„œì˜ íš¨ìš©ì„ í¬ê²Œ ëŠë¼ì§€ ëª»í•œë‹¤**ê³  ë‹µí•¨
  - CEOì˜ 90%ëŠ” **ì •ëŸ‰ì ì¸ ë°ì´í„°**ë¥¼ í†µí•´ ì˜ì‚¬ì†Œí†µí•˜ëŠ” CFO ë° CIOë¥¼ ì‹ ë¢°í•œë‹¤ê³  ë‹µí•¨
  â†’ ë”°ë¼ì„œ, ë§ˆì¼€íŒ… íˆ¬ìì— ëŒ€í•œ ì •ëŸ‰ì ì¸ í‰ê°€ëŠ” ë”ë”ìš± ì¤‘ìš”!
  </aside>

### MMM ì ìš© ë°©ë²•

* ë§¤ì¼ í˜¹ì€ ë§¤ì£¼ ë§ˆì¼€íŒ… í™œë™ì˜ ë°©ì‹, ë¹„ìš©(=íˆ¬ì)ì€ ë³€í•˜ê¸° ë§ˆë ¨ì´ê³ , ê·¸ì— ë”°ë¼ ë§¤ì¶œë„ ë³€í™”í•¨
* â†’ ë§¤ì¶œì„ ê´€ì¸¡í•´ì„œ ë§ˆì¼€íŒ… ë¹„ìš©ê³¼ì˜ ì¸ê³¼ê´€ê³„ë¥¼ ì¸¡ì •(íšŒê·€ë¶„ì„)í•˜ë©´ ê°ê°ì˜ ë§ˆì¼€íŒ… ë°©ì‹ì— ëŒ€í•œ íˆ¬ìê°€ í–¥í›„ ë§¤ì¶œì— ë¯¸ì¹˜ëŠ” ì˜í–¥ë„ ê³¼í•™ì ìœ¼ë¡œ ì˜ˆì¸¡ ê°€ëŠ¥
* ì˜ˆì‹œ
  * ì•„ë˜ì™€ ê°™ì´ ë§ˆì¼€íŒ… ì±„ë„ì— ë”°ë¥¸ ë¹„ìš©ê³¼ ë§¤ì¶œì„ ì£¼ë‹¨ìœ„ë¡œ ì§‘ê³„í•œ ë‹¤ìŒ íšŒê·€ë¶„ì„ì„ ì‹œë„í•  ìˆ˜ ìˆìŒ
  * $Î²1*TV + Î²2*SNS + Î²3*Web + Î²4*PaidSearch + â€¦ = ë§¤ì¶œ(y)$

![Imgur](https://i.imgur.com/u7WOZyz.png)

### ì°¸ê³ . ê¸°ì¡´ì˜ ë§ˆì¼€íŒ… íˆ¬ì/ì˜ˆì‚° í¸ì„± ë°©ì‹(without MMM)

* ë¹„ìœ¨ ê¸°ë°˜ ë°©ì‹(Ratio Driven)
  * ì œí’ˆêµ°ë“¤
  * ê°ê°ì´ ì°¨ì§€í•˜ëŠ” ì „ë…„ ë§¤ì¶œ ë¹„ì¤‘ì— ë”°ë¼ ë§ˆì¼€íŒ… ì˜ˆì‚°ì„ ë¶„ë°°í•˜ëŠ” ë°©ì‹
    * e.g. ë§¤ì¶œë¹„ê°€ Aì œí’ˆ : Bì œí’ˆ : Cì œí’ˆ = 5 : 3 : 2ë¼ë©´ ì˜ˆì‚°ë„ 5 : 3 : 2ë¡œ í¸ì„±
  * ë‹¨ì  : ë¯¸ë˜ ì„±ì¥ ê¸°íšŒê°€ ë°˜ì˜ë˜ì§€ ì•Šê³ , ì„±ìˆ™ ì‹œì¥ì—ë§Œ ì§€ë‚˜ì¹œ ì˜ˆì‚°ì´ íˆ¬ì…ë  ìˆ˜ ìˆìŒ + ê²½ìŸ í™˜ê²½ì˜ ì°¨ì´ê°€ ë¬´ì‹œë¨
* ê³¼ê±° íˆ¬ì ê¸°ë°˜(History Plus)
  * ì§€ë‚œí•´ íˆ¬ìë¥¼ í† ëŒ€ë¡œ ë‚´ë…„ ê²½ì˜ í™˜ê²½ & ìˆ˜ìµì„± ëª©í‘œë¥¼ ê³ ë ¤í•´ ì¡°ì •í•˜ì—¬ í¸ì„±
  * ê³¼ê±° íˆ¬ìê°€ ì˜ëª»ë˜ì—ˆë‹¤ë©´ ë”ìš± ì•…í™”ë  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ë‚˜, ê²½ì˜ì§„ ì…ì¥ì—ì„œëŠ” ì¢‹ì€ ì„±ê³¼ë¥¼ ë‚´ëŠ” ì œí’ˆ/ì§€ì—­ì— ëŒ€í•´ íˆ¬ìë¥¼ ì¶•ì†Œí•˜ëŠ” ê²ƒì´ êº¼ë ¤ì§€ëŠ” ì„ íƒì´ê¸° ë•Œë¬¸ì— ë§ì€ ê¸°ì—…ë“¤ì´ ì‚¬ìš©í•˜ëŠ” ë°©ì‹
* ê°€ì¤‘ í‰ê·  ê¸°ë°˜(Driven by weighted average)
  * ì‹œì¥ê·œëª¨, ì„±ì¥ì„±, ê²½ìŸ ìƒí™© ë“±ì„ ì •ë¦¬í•´ ë§¤ì¶œ íš¨ê³¼ë¥¼ ì •ëŸ‰ì ìœ¼ë¡œ ë¶„ì„í•˜ë©°, ìš”ì¸ë³„ ê°€ì¤‘ì¹˜ë¥¼ ê²°ì •í•˜ê³  ëª¨ë“  ìš”ì¸ë“¤ì˜ ê°€ì¤‘ í‰ê· ì¹˜ë¥¼ êµ¬í•¨
  * ë‹¨ì  : ê°€ì¤‘ì¹˜ë¥¼ ì •í•˜ëŠ” ë°©ì‹ì— ì£¼ê´€ì´ ê°œì…í•  ìˆ˜ ìˆìŒ
* **ê°ê°ì˜ ë°©ë²•ë“¤ì˜ ë‹¨ì ì„ ë³´ì™„í•´ì„œ íš¨ìœ¨ ë†’ì€ ë§ˆì¼€íŒ… ì˜ˆì‚° í¸ì„±ì„ ìœ„í•´ MMMì„ í•œë‹¤ê³  ì´í•´!**

## 2. MMMì‚¬ë¡€

* í†µì‹ ì‚¬ì˜ ë§ˆì¼€íŒ… íˆ¬ì ë°˜ì‘ê³¡ì„  ì‚¬ë¡€
  * ë§ˆì¼€íŒ… íˆ¬ìì™€ ì¶”ê°€ ê³ ê° ìœ ì¹˜ì™€ì˜ ê´€ê³„ë¥¼ ì•„ë˜ì™€ ê°™ì´ ìˆ˜í•™ì‹ìœ¼ë¡œ í‘œí˜„(ë§ˆì¼€íŒ… íˆ¬ì ë°˜ì‘ê³¡ì„ )í•˜ë©´ ì±„ë„ë³„ë¡œ ì¶”ê°€/ê°ì†Œë˜ëŠ” ë§ˆì¼€íŒ… íˆ¬ìê°€ ì¶”ê°€ ê³ ê° ìœ ì¹˜ì— ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ì§€, íˆ¬ì ìˆ˜ìµë¥ ì´ ë†’ì€ ì±„ë„ì€ ì–´ë””ì¸ì§€ ì•Œ ìˆ˜ ìˆìŒ
  * ì•„ë˜ ê³¡ì„ ì—ì„œ
    * Display, Affiliates : ì´ˆê¸° íˆ¬ììˆ˜ìµë¥ ì€ ë†’ì§€ë§Œ, í¬í™”ìƒíƒœê°€ ì¼ì° ì°¾ì•„ì˜´
    * TV : ìˆ˜ìµì„±ì„ ì±™ê¸°ë©´ì„œ ì¶”ê°€ê³ ê° ìœ ì¹˜ ê°€ëŠ¥
    * â†’ Display, Affiliatesì— íˆ¬ìí•˜ê¸° ë³´ë‹¤ëŠ” TV ê´‘ê³ ì— íˆ¬ìí•´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŒ
    * cf. Affiliates Mkt : ì œíœ´ë§ˆì¼€íŒ…, ë§¤ì²´/ë§¤ì²´ì‚¬ì˜ ì‹¤ì (í´ë¦­, êµ¬ë§¤, ì¡°íšŒ ë“±)ì— ë”°ë¼ ê´‘ê³ ë¹„ ì§€ê¸‰í•˜ëŠ” ë°©ì‹. êµ¬ê¸€ ì• ë“œì„¼ìŠ¤ë¥¼ ìƒê°í•˜ë©´ ì‰¬ìš¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤!

![Imgur](https://i.imgur.com/q8rLk70.png)

## ì°¸ê³ . ì„ í˜•íšŒê·€

### ì„ í˜•íšŒê·€ë€ ?

* íšŒê·€ë¶„ì„ì€ ì¢…ì†ë³€ìˆ˜ yì™€ ê°€ì¥ ë¹„ìŠ·í•œ ê°’ ğ‘¦Ì‚ì„ ì¶œë ¥í•˜ëŠ” í•¨ìˆ˜ $f(x)$ë¥¼ ì°¾ëŠ” ê³¼ì •ìœ¼ë¡œë„ ë³¼ ìˆ˜ ìˆìŒ!
  * ğ‘¦Ì‚=ğ‘“(ğ‘¥)â‰ˆğ‘¦
* ì´ë•Œ $f(x)$ê°€ ì„ í˜•í•¨ìˆ˜ë©´ ì´ í•¨ìˆ˜ë¥¼ ì„ í˜•íšŒê·€ëª¨í˜•ì´ë¼ê³  í•˜ê³ , ì„ í˜•íšŒê·€ëª¨í˜•ì„ ì‚¬ìš©í•˜ëŠ” íšŒê·€ë¶„ì„ì„ ì„ í˜•íšŒê·€ë¶„ì„ì´ë¼ê³  í•¨
  * ğ‘¦Ì‚=ğ‘¤0+ğ‘¤1ğ‘¥1+ğ‘¤2ğ‘¥2+â‹¯+ğ‘¤ğ·ğ‘¥ğ·
* ë‹¤ë¥´ê²Œ í‘œí˜„í•˜ë©´, ì¢…ì†ë³€ìˆ˜ yì™€ í•œ ê°œ ì´ìƒì˜ ë…ë¦½ë³€ìˆ˜ Xì™€ì˜ ì„ í˜• ìƒê´€ ê´€ê³„ë¥¼ ëª¨ë¸ë§ í•˜ëŠ” ê²ƒ

![Imgur](https://i.imgur.com/LToBOG6.png)

### OLS(ìµœì†ŒììŠ¹ë²•)

* OLS(Ordinary Least Squares)ëŠ” ì”ì°¨ì œê³±í•©(RSS:Residual Sum of Squares)ë¥¼ ìµœì†Œí™”í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì„ í˜•íšŒê·€ëª¨í˜•ì„ êµ¬í•˜ëŠ” ê²ƒ
  * ì”ì°¨ : ì¢…ì†ë³€ìˆ˜ yì™€ ì¶”ì •ì¹˜ ğ‘¦Ì‚ì˜ ì°¨ì´ â†’ ì”ì°¨ì œê³±í•©ì€ ì´ ì”ì°¨ë“¤ì„ ë§ê·¸ëŒ€ë¡œ ì œê³±í•´ì„œ ë”í•œê°’ìœ¼ë¡œ, ì”ì°¨ì˜ í¬ê¸° ì •ë„ë¡œ ë³¼ ìˆ˜ ìˆìŒ

### ì•Œê³ ì“°ëŠ” R-squared (ê²°ì •ê³„ìˆ˜, ì„¤ëª…ë ¥)

* ê²°ì •ê³„ìˆ˜

  * íšŒê·€ëª¨ë¸ì—ì„œ ë…ë¦½ë³€ìˆ˜ê°€ ì¢…ì†ë³€ìˆ˜ë¥¼ ì–´ëŠ ì •ë„ ì„¤ëª…í•˜ëŠ”ì§€ë¥¼ í‘œí˜„í•˜ëŠ” ì§€í‘œ
  * 0~1ì˜ ê°’ì„ ê°€ì§€ë©°, 1ì— ê°€ê¹Œìš¸ ìˆ˜ë¡ ì„¤ëª…ë ¥ì´ ë†’ìŒ
    * e.g. ê²°ì •ê³„ìˆ˜ê°€ 0.7ì´ë¼ë©´ ë…ë¦½ë³€ìˆ˜ë“¤ì´ ì¢…ì†ë³€ìˆ˜ì˜ 70% ì •ë„ë¥¼ ì„¤ëª…í•œë‹¤ê³  ë´„
    * cf. ë…ë¦½ë³€ìˆ˜ì˜ ìˆ˜ê°€ ì¦ê°€í•˜ë©´ ê²°ì •ê³„ìˆ˜ë„ ìƒìŠ¹í•¨ â†’ ë”°ë¼ì„œ ê²°ì •ê³„ìˆ˜ë§Œ ê°–ê³  íšŒê·€ëª¨ë¸ì„ íŒë‹¨í•˜ëŠ” ê²ƒì€ ìœ„í—˜!
* ì˜ë¯¸

  * íšŒê·€ëª¨ë¸ì´ ì¢…ì†ë³€ìˆ˜ë¥¼ ì„¤ëª…í•˜ëŠ” ë¹„ìœ¨ë¡œ ìƒê°í•˜ë©´ ì‰¬ìš´ë°, ì°¨ê·¼ì°¨ê·¼ ë´…ì‹œë‹¤!
    * cf. yi = ì‹¤ì œ ì¢…ì†ë³€ìˆ˜, y hat(ğ‘¦Ì‚) = ì¶”ì •ê°’, y bar(È³) = ì¢…ì†ë³€ìˆ˜ yì˜ í‰ê· ê°’
    * ë§Œì•½ ìš°ë¦¬ê°€ **ì¢…ì†ë³€ìˆ˜ yë¥¼ ì •ë§ ì‰½ê³  ë‹¨ìˆœí•˜ê²Œ ì¶”ì •í•œë‹¤ë©´ ì¢…ì†ë³€ìˆ˜ yë“¤ì˜ í‰ê· **ìœ¼ë¡œ êµ¬í•´ë³¼ ìˆ˜ ìˆìŒ. ì¦‰ ìš°ë¦¬ê°€ íšŒê·€ ëª¨ë¸ë§ì„ í•œë‹¤ëŠ” ê²ƒì€ y bar(È³)ë³´ë‹¤ ì˜í•˜ê¸° ìœ„í•´ í•˜ëŠ” ê²ƒì´ê³ , yì˜ í‰ê· ê°’ì¸ È³ëŠ” ë² ì´ìŠ¤ë¼ì¸ ì—­í• 
      * ê·¸ë˜ì„œ ìš°ë¦¬ê°€ ë§Œë“¤ì–´ë‚¸ íšŒê·€ëª¨ë¸ì´ y bar(ì´ë¯¸ì§€ì˜ íŒŒë€ì„ ) ìˆ˜ì¤€ì´ë¼ë©´ ê²°êµ­ ë² ì´ìŠ¤ë¼ì¸ì´ë¯€ë¡œ ëª¨í˜•ì— ì˜í•´ ì„¤ëª…ë˜ëŠ” ë¶€ë¶„ì´ 0 = SSE 0
    * í•œí¸ ìš°ë¦¬ê°€ ë„ˆë¬´ë„ˆë¬´ ì¶”ì •ì„ ì˜í•´ì„œ ì‹¤ì œ ì¢…ì†ë³€ìˆ˜(yi)ë¥¼ ì œëŒ€ë¡œ ì¶”ì •í•´ë²„ë¦¬ë©´ íšŒê·€ëª¨ë¸ì€ yië¥¼ ì§€ë‚˜ê°€ê² ì§€ë§Œ, í˜„ì‹¤ì ìœ¼ë¡œëŠ” ê·¸ëŸ¬ê¸° í˜ë“¤ê³ (í˜¹ì€ ê³¼ì í•©â€¦??) yiì™€ y bar ì‚¬ì´ ì–´ë”˜ê°€ì—ì„œ íšŒê·€ëª¨ë¸ì´ ê·¸ì–´ì§ˆ ê²ƒ
      * ì¦‰ **ê²°ì •ê³„ìˆ˜ë€ ìš°ë¦¬ì˜ íšŒê·€ëª¨ë¸ì´ ê·¸ëƒ¥ í‰ê· ê°’ìœ¼ë¡œ ì¶”ì •í•´ë²„ë¦¬ëŠ” ê²ƒì— ë¹„í•´ ì–¼ë§ˆë‚˜ ì‹¤ì œ ê´€ì¸¡ê°’ê³¼ ê°€ê¹ê²Œ ì¶”ì •í–ˆëŠ”ì§€ë¥¼ íŒë‹¨í•˜ê¸° ìœ„í•œ ì§€í‘œ**ë¼ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤!
* ê³„ì‚°
* ![Imgur](https://i.imgur.com/Aa5rv1b.png)
  ì´ê²Œ ë­”ì†Œë¦°ë°?!

  * ê²°ê³¼ì ìœ¼ë¡œ ê²°ì •ê³„ìˆ˜ëŠ” ë‘ ê°€ì§€ ë°©ì‹ìœ¼ë¡œ êµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
    * SST : ë¨¼ì € ì‹¤ì œ ê´€ì¸¡ê°’(yi)ë“¤ê³¼ ê´€ì¸¡ê°’ì˜ í‰ê· ê°’(y bar)ì˜ ì°¨ì´ì˜ ì œê³±í•©ì„ êµ¬í•©ë‹ˆë‹¤

      * ìœ„ì—ì„œ ë§í–ˆë“¯, ìš°ë¦¬ëŠ” ë­˜í•´ë„ í‰ê· ê°’ ë§Œí¼ì€ ì¶”ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      * ë”°ë¼ì„œ ìš°ë¦¬ê°€ ì„¤ëª…í•  ë¶€ë¶„ì€ ê´€ì¸¡ê°’(ì¢…ì†ë³€ìˆ˜)ì™€ í‰ê· ê°’ ê°„ì˜ ì°¨ì´ ì…ë‹ˆë‹¤.
    * 1. SSE : íšŒê·€ëª¨ë¸ê³¼ í‰ê· ê°’ ê°„ì˜ ì°¨ì´ì˜ ì œê³±í•©

      * Explained Sum, ê²°êµ­ íšŒê·€ì„ ì´ í‰ê· ì— ë¹„í•´ ì–¼ë§ˆë‚˜ ì‹¤ì œ ê´€ì¸¡ê°’ì— ê°€ê¹Œì›Œì§€ê²Œ ì¶”ì •í–ˆëŠ”ì§€, ì¦‰ ì–¼ë§ˆë‚˜ ì„¤ëª…í–ˆëŠ”ì§€(explained)ë¥¼ ì˜ë¯¸
    * 2. SSR : ì‹¤ ê´€ì¸¡ê°’ê³¼ íšŒê·€ëª¨ë¸ ê°„ì˜ ì°¨ì´ì˜ ì œê³±í•©

      * Residual Sum, íšŒê·€ì„ ì´ ì‹¤ì œ ê´€ì¸¡ê°’ê³¼ ì–¼ë§ˆë‚˜ ì°¨ì´ê°€ ë‚˜ëŠ”ì§€ë¥¼ ì˜ë¯¸
    * ìœ„ ê°’ë“¤ì„ ê°€ì§€ê³  SSE/SST í˜¹ì€ 1 - (SSR/SST)ë¡œ ê³„ì‚° ê°€ëŠ¥!

      * ê³µì‹ì— ë”°ë¼ì„œ, ìš°ë¦¬ì˜ íšŒê·€ëª¨ë¸ì´ í‰ê·  ìˆ˜ì¤€ì´ë¼ë©´ SSEê°€ 0ì´ ë˜ë¯€ë¡œ R^2 = 0
      * íšŒê·€ëª¨ë¸ì´ ê´€ì¸¡ê°’ì„ ì™„ë²½í•˜ê²Œ ì¶”ì •í–ˆë‹¤ë©´ SSRì´ 0ì´ ë˜ë¯€ë¡œ R^2 = 1
* í•œê±¸ìŒ ë” : ì¡°ì •ëœ ê²°ì •ê³„ìˆ˜(Adjusted R-Squared)

  * ìœ„ì—ì„œ ì–¸ê¸‰í•œ ê²ƒì²˜ëŸ¼, ë…ë¦½ë³€ìˆ˜ì˜ ìˆ˜ê°€ ì¦ê°€í•˜ë©´ ê²°ì •ê³„ìˆ˜ëŠ” ì¦ê°€í•  ìˆ˜ ë°–ì— ì—†ìŒ
  * ë”°ë¼ì„œ ë…ë¦½ë³€ìˆ˜ê°€ ì¦ê°€í•˜ë”ë¼ë„ ë…ë¦½ë³€ìˆ˜ ì¦ê°€ì— ë”°ë¥¸ íš¨ê³¼ë¥¼ ì–µì œì‹œí‚¤ëŠ” ì—°ì‚°ì´ í•„ìš”í•˜ê³ , ì´ ì—°ì‚°ì„ ê±°ì¹œ ê²ƒì´ ì¡°ì •ëœ ê²°ì •ê³„ìˆ˜!

 ![Imgur](https://i.imgur.com/QpSSvr2.png)

* cf. n = í‘œë³¸ì˜ ìˆ˜, k = ë…ë¦½ë³€ìˆ˜ì˜ ìˆ˜

# Practice

## Dataset

* 4ê°œ ì»¬ëŸ¼ìœ¼ë¡œ êµ¬ì„± (ì²«ë²ˆì§¸ ì»¬ëŸ¼ì€ row number)
* ê° í–‰ì€ ì„¸ ê°œì˜ ì±„ë„(TV, Radio, Newspaper) ê°ê°ì— ëŒ€í•œ ë§ˆì¼€íŒ… íˆ¬ì ë¹„ìš©ê³¼ ë§¤ì¶œ(sales)ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŒ

[Advertising and Sales](https://www.kaggle.com/datasets/sazid28/advertising.csv)

## Codes

### Setup & import

```python
# Setup
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# import 
df = pd.read_csv('Advertising.csv')
```

### Describe

```python
# ê° ì»¬ëŸ¼ì˜ ì „ë°˜ì ì¸ ê°’ì˜ ìƒíƒœë¥¼ íŒŒì•…í•´ë³´ëŠ”ë²• !
# mean, std, min/maxë¡œ ì´ìƒì¹˜ê°€ ìˆëŠ”ì§€ë¥¼ í™•ì¸í•´ë³¼ ìˆ˜ ìˆìŒ
df.describe()

#ì €ëŠ” info()ë„ ì°ì–´ë³´ëŠ” í¸ì´ì—ìš” nullì—¬ë¶€ë‘ data type ë³´ë ¤ê³ 
df.info()
```

### Correlation

```python
corr = df.corr() #correlation ê³„ì‚° (-> ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë°˜í™˜)
sns.heatmap(corr, #ë°ì´í„°ëŠ” ìœ„ì—ì„œ ê³„ì‚°í•œ correlation dataframe
            xticklabels=corr.columns, #xì¶• ë¼ë²¨ : correlation dataframeì˜ columns
            yticklabels=corr.columns, #yì¶• ë¼ë²¨ : correlation dataframeì˜ columns
            annot=True, #ê°’ í‘œì‹œ ì—¬ë¶€ ì„¤ì • 
            cmap=sns.diverging_palette(220, 20, as_cmap=True))#ë‘ ê°œ ìƒ‰ìƒì‚¬ì´ì˜ palette ë§Œë“¤ê¸° 
# strong correlation between Tv and sales (0.78)
```

![Imgur](https://i.imgur.com/Vo6qlmu.png)

- df.corr()ë§Œ ì°ì–´ë³´ë©´ ì´ë ‡ê²Œ correlationì„ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤

### Pair Plot

* pair plotì€ ë°ì´í„° ë‚´ì˜ ê° ì»¬ëŸ¼ë“¤ì„ ê°–ê³ , ê° ì»¬ëŸ¼(ë³€ìˆ˜)ë“¤ì„ ê°–ê³  ë§Œë“¤ì–´ë‚¼ ìˆ˜ ìˆëŠ” ëª¨ë“  ë³€ìˆ˜ ì¡°í•©ì˜ ë¶„í¬ë„ë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒ

```python
sns.pairplot(df)
```

* cf. ì—¬ê¸° pairplot ì˜µì…˜ ì„¤ëª…ì´ ì˜ ë˜ì–´ ìˆë„¤ìš”!
* pair-plotì—ì„œë„ X variablesì™€ Y variableë¥¼ ì§€ì •í•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤!

```python
sns.pairplot(df, x_vars = ['TV','radio','newspaper'], y_vars='sales',size=7, kind='reg')
```

![Imgur](https://i.imgur.com/2C5T7PG.png)

### OLS(ìµœì†ŒììŠ¹ë²•)

* ìœ„ì—ì„œ ì„¤ëª…í•œ ìµœì†ŒììŠ¹ë²•ì„ ì‚¬ìš©í•œ íšŒê·€ëª¨ë¸ë§ + ê·¸ì— ëŒ€í•œ summaryë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤
  * ê²°ì •ê³„ìˆ˜ëŠ” 0.897, ì¡°ì •ëœ ê²°ì •ê³„ìˆ˜ë„ 0.896 â†’ ìš°ë¦¬ì˜ íšŒê·€ëª¨ë¸ì´ ì¢…ì†ë³€ìˆ˜ì¸ salesë¥¼ ì•½ 90% ì •ë„ ì„¤ëª…í•œë‹¤ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤!
  * ì•„ë˜ coefë¥¼ ê³ ë ¤í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ íšŒê·€ì‹ì„ ì–»ì—ˆë‹¤ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    * $Sales = 2.9389 + 0.0458*TV + 0.1885*Radio -0.0010*Newspaper$
    * ì˜ì™¸ë¡œ ë¼ë””ì˜¤ì˜ íš¨ê³¼ê°€ ì¢‹ë„¤ìš”â€¦?
    * ì‹ ë¬¸ì€ ìˆìœ¼ë‚˜ ë§ˆë‚˜â€¦ pê°’ë„ ë„ˆë¬´ í¬ê¸´ í•˜ì§€ë§Œìš”!

```python
import statsmodels.formula.api as sm
model = sm.ols(formula="sales~TV+radio+newspaper", data=df).fit()
#dfëŠ” ë…ë¦½ë³€ìˆ˜, ì¢…ì†ë³€ìˆ˜ê°€ ëª¨ë‘ í¬í•¨ëœ ë°ì´í„°í”„ë ˆì„
#formularëŠ” ì¢…ì†ë³€ìˆ˜ì™€ ë…ë¦½ë³€ìˆ˜ë¥¼ ì§€ì •
#fit ë©”ì„œë“œë¡œ ëª¨í˜•ì„ ì¶”ì • -> RegressionResultsë¼ëŠ” í´ë˜ìŠ¤ ê°ì²´ë¡œ ì¶”ì • ê²°ê³¼ ì¶œë ¥ 
print(model.summary())
```

![Imgur](https://i.imgur.com/XGgHUKk.png)

* ì°¸ê³ 
  * sm.add_constant(x) : ìƒìˆ˜í•­ ì»¬ëŸ¼ ì¶”ê°€ (ë°ì´í„°í”„ë ˆì„ì— constí•­ì´ ì¶”ê°€ë¨)
  * model.summary() : RegressionResults í´ë˜ìŠ¤ ê°ì²´ì˜ ê²°ê³¼ summary ë©”ì„œë“œ
  * model.predict() : modelì— ê¸°ë°˜í•œ predictìš© ë©”ì„œë“œ

```sql
Dep. Variable: ì¢…ì†ë³€ìˆ˜

R-squared: ê²°ì •ê³„ìˆ˜ - **ëª¨í˜•ì˜ ì„¤ëª…ë ¥** x100í•´ì„œ ì¸¡ì •

Model: ë¶„ì„ëª¨í˜•

Adj. R-squared: ì¡°ì •ëœ ê²°ì •ê³„ìˆ˜ **ëª¨í˜•ì˜ ì„¤ëª…ë ¥** x100í•´ì„œ ì¸¡ì • - ë…ë¦½ë³€ìˆ˜ê°€ ë§ì•„ì§€ë©´ì„œ íŒ¨ë„í‹°ê°€ ì£¼ì–´ì§€ëŠ” ê²ƒ

Method: ëª¨í˜• ê³„ì‚°ë°©ì‹

F-statistics: ëª¨í˜• ì í•©ë„ í†µê³„ëŸ‰

Prob(F-statistics): F í†µê³„ëŸ‰ì˜ ìœ ì˜í™•ë¥ 

DF Residuals: ì”ì°¨ì˜ ììœ ë„

DF Model: ëª¨í˜•ì˜ ë§¤ê°œë³€ìˆ˜ ìˆ˜

AIC/BIC: ì—¬ëŸ¬ ëª¨í˜•ì˜ ì í•©ë„ ë¹„êµ

std err: ê³„ìˆ˜ ì¶”ì •ì¹˜ì˜ í‘œì¤€ì˜¤ì°¨

t: t-value ê²€ì •í†µê³„ëŸ‰

P>|t|: ìœ ì˜í™•ë¥  - p valueê°€ ë§¤ìš° ì‘ì•„ì•¼ ëª¨í˜•ì´ ì í•©í•˜ë‹¤ - ê³„ìˆ˜ë„ ì í•©í•˜ë‹¤.

[0.025 0.975]: 95% ì‹ ë¢°êµ¬ê°„ ë²”ìœ„

Omnibus: ì”ì°¨ì˜ ì™œë„/ì²¨ë„ ê²€ì •í†µê³„ëŸ‰

Prob(Omnibus): Omnibusì˜ ìœ ì˜í™•ë¥ 

Skew/Kurtosis: ì™œë„/ì²¨ë„

Durbin-Watson: ì”ì°¨ì˜ ë…ë¦½ì„± ê²€ì •í†µê³„ëŸ‰

Jarque-Bera(JB): ì”ì°¨ì˜ ì™œë„/ì²¨ë„ ê²€ì •í†µê³„ëŸ‰

Prob(JB): JBì˜ ìœ ì˜í™•ë¥ 

Cond. No.: ë‹¤ì¤‘ê³µì„ ì„± ê²€ì •í†µê³„ëŸ‰
```



### Random Forest Regression

* ì°¸ê³ . mae = í‰ê· ì ˆëŒ€ì˜¤ì°¨ (ì ˆëŒ€ ì˜¤ì°¨ì˜ í‰ê· ), ì¶”ì •ì •í™•ë„ì˜ ì²™ë„

```python
# random Foreset model
# Setting X and y variables
X = df.loc[:, df.columns != 'sales'] #sales ì œì™¸ ë³€ìˆ˜ë¥¼ X variableë¡œ ì •ì˜
y = df['sales'] # sales ë³€ìˆ˜ë¥¼ y variableë¡œ ì •ì˜ 

# Building Random Forest model
from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_absolute_error as mae 

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.25, random_state=0)
#train, test ë°ì´í„°ë¥¼ ë‚˜ëˆ„ëŠ” ê³¼ì • 
#test ë°ì´í„°ëŠ” ì „ì²´ì˜ 25%ë¡œ ì„¤ì •
#random_stateëŠ” ë‚œìˆ˜ì˜ seed number 
model = RandomForestRegressor(random_state=1)
model.fit(X_train, y_train)
pred = model.predict(X_test)

# Visualizing Feature Importance
feat_importances = pd.Series(model.feature_importances_, index=X.columns)
feat_importances.nlargest(10).plot(kind='barh',figsize=(10,10))
# TV is the most important
```

# Reference

* MMM

[[DBR] í—·ê°ˆë¦¬ëŠ” ë§ˆì¼€íŒ… ë¹„ìš©ì˜ ì„±ê³¼ ì •ëŸ‰í™”í•  ë°©ë²•, ì°¾ê³  ë˜ ì°¾ì•„ë¼](https://dbr.donga.com/article/view/1205/article_no/6500/ac/magazine)

* seabornì˜ diverging paletter documentation â†’ ìƒ‰ìƒ ì»¤ìŠ¤í…€ í•˜ê³  ì‹¶ìœ¼ë©´ ì°¸ê³ !

[seaborn.diverging_palette - seaborn 0.11.2 documentation](https://seaborn.pydata.org/generated/seaborn.diverging_palette.html)

* ì„ í˜•íšŒê·€

[ì„ í˜• íšŒê·€ - ìœ„í‚¤ë°±ê³¼, ìš°ë¦¬ ëª¨ë‘ì˜ ë°±ê³¼ì‚¬ì „](https://ko.wikipedia.org/wiki/%EC%84%A0%ED%98%95_%ED%9A%8C%EA%B7%80)

[ë°ì´í„° ì‚¬ì´ì–¸ìŠ¤ ìŠ¤ì¿¨](https://datascienceschool.net/03%20machine%20learning/04.02%20%EC%84%A0%ED%98%95%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D%EC%9D%98%20%EA%B8%B0%EC%B4%88.html)

[[R] ê²°ì •ê³„ìˆ˜(R-Squared)ì˜ ì˜ë¯¸ì™€ ê³„ì‚° ë°©ë²•](https://m.blog.naver.com/tlrror9496/222055889079)

[ë‹¤ì¤‘ì„ í˜•íšŒê·€ ê¹ƒí—ˆë¸Œ ì„¤ëª…ë§í¬ - ì„¤ìœ í™˜ ](https://github.com/syh0397/Statistics_python/blob/main/11_%EB%8B%A4%EC%A4%91%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D(Multiple_Regression_Analysis).ipynb)
